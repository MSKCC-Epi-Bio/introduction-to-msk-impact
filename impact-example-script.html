<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>IMPACT Example Script</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="impact-example-script_files/libs/clipboard/clipboard.min.js"></script>
<script src="impact-example-script_files/libs/quarto-html/quarto.js"></script>
<script src="impact-example-script_files/libs/quarto-html/popper.min.js"></script>
<script src="impact-example-script_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="impact-example-script_files/libs/quarto-html/anchor.min.js"></script>
<link href="impact-example-script_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="impact-example-script_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="impact-example-script_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="impact-example-script_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="impact-example-script_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">IMPACT Example Script</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="pulling-data" class="level1">
<h1>Pulling Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cbioportalR)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.0      ✔ stringr 1.4.1 
✔ readr   2.1.2      ✔ forcats 0.5.2 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("MSKCC-Epi-Bio/gnomeR")</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gnomeR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2

Attaching package: 'gnomeR'

The following object is masked from 'package:cbioportalR':

    impact_gene_info</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_cbioportal_db</span>(<span class="st">"public"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ You are successfully connected!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ base_url for this R session is now set to "www.cbioportal.org/api" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_cbioportal_db</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ You are successfully connected!</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>all_studies <span class="ot">&lt;-</span> <span class="fu">available_studies</span>()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>all_studies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 354 × 13
   studyId   name  descr…¹ publi…² groups status impor…³ allSa…⁴ readP…⁵ cance…⁶
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;lgl&gt;   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;lgl&gt;   &lt;chr&gt;  
 1 acc_tcga  Adre… "TCGA … TRUE    "PUBL…      0 2022-0…      92 TRUE    acc    
 2 bcc_unig… Basa… "Whole… TRUE    "PUBL…      0 2022-0…     293 TRUE    bcc    
 3 ampca_bc… Ampu… "Exome… TRUE    "PUBL…      0 2022-0…     160 TRUE    ampca  
 4 blca_dfa… Blad… "Whole… TRUE    "PUBL…      0 2022-0…      50 TRUE    blca   
 5 blca_msk… Blad… "Compr… TRUE    "PUBL…      0 2022-0…      97 TRUE    blca   
 6 blca_bgi  Blad… "Whole… TRUE    "PUBL…      0 2022-0…      99 TRUE    blca   
 7 blca_msk… Blad… "Genom… TRUE    "PUBL…      0 2022-0…     109 TRUE    blca   
 8 all_stju… Hypo… "Whole… TRUE    ""          0 2022-0…      44 TRUE    myeloid
 9 acyc_fmi… Aden… "Targe… TRUE    "ACYC…      0 2022-0…      28 TRUE    acyc   
10 acyc_san… Aden… "Whole… TRUE    "ACYC…      0 2022-0…      24 TRUE    acyc   
# … with 344 more rows, 3 more variables: referenceGenome &lt;chr&gt;, pmid &lt;chr&gt;,
#   citation &lt;chr&gt;, and abbreviated variable names ¹​description, ²​publicStudy,
#   ³​importDate, ⁴​allSampleCount, ⁵​readPermission, ⁶​cancerTypeId</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>all_studies <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(studyId <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"blca_nmibc_2017"</span>, <span class="st">"prad_msk_2019"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
  studyId    name  descr…¹ publi…² groups status impor…³ allSa…⁴ readP…⁵ cance…⁶
  &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;   &lt;lgl&gt;   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;lgl&gt;   &lt;chr&gt;  
1 blca_nmib… Nonm… IMPACT… TRUE    PUBLIC      0 2022-0…     105 TRUE    blca   
2 prad_msk_… Pros… MSK-IM… TRUE    PUBLIC      0 2022-0…      18 TRUE    prosta…
# … with 3 more variables: referenceGenome &lt;chr&gt;, pmid &lt;chr&gt;, citation &lt;chr&gt;,
#   and abbreviated variable names ¹​description, ²​publicStudy, ³​importDate,
#   ⁴​allSampleCount, ⁵​readPermission, ⁶​cancerTypeId</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_study_info</span>(<span class="st">"blca_nmibc_2017"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            [,1]                                                                           
name                        "Nonmuscle Invasive Bladder Cancer (MSK Eur Urol 2017)"                        
description                 "IMPACT sequencing of 105 High Risk Nonmuscle Invasive Bladder Cancer samples."
publicStudy                 "TRUE"                                                                         
pmid                        "28583311"                                                                     
citation                    "Pietzak et al. Eur Urol 2017"                                                 
groups                      "PUBLIC"                                                                       
status                      "0"                                                                            
importDate                  "2022-08-17 22:59:50"                                                          
allSampleCount              "105"                                                                          
sequencedSampleCount        "105"                                                                          
cnaSampleCount              "105"                                                                          
mrnaRnaSeqSampleCount       "0"                                                                            
mrnaRnaSeqV2SampleCount     "0"                                                                            
mrnaMicroarraySampleCount   "0"                                                                            
miRnaSampleCount            "0"                                                                            
methylationHm27SampleCount  "0"                                                                            
rppaSampleCount             "0"                                                                            
massSpectrometrySampleCount "0"                                                                            
completeSampleCount         "0"                                                                            
readPermission              "TRUE"                                                                         
studyId                     "blca_nmibc_2017"                                                              
cancerTypeId                "blca"                                                                         
cancerType.name             "Bladder Urothelial Carcinoma"                                                 
cancerType.dedicatedColor   "Yellow"                                                                       
cancerType.shortName        "BLCA"                                                                         
cancerType.parent           "bladder"                                                                      
cancerType.cancerTypeId     "blca"                                                                         
referenceGenome             "hg19"                                                                         </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">available_samples</span>(<span class="st">"blca_nmibc_2017"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sampleId, patientId, studyId) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">available_samples</span>(<span class="st">"prad_msk_2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sampleId,  patientId, studyId) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>df_pairs <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(s1, s2) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>patientId)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>df_pairs <span class="ot">&lt;-</span> df_pairs <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"sample_id"</span> <span class="ot">=</span> sampleId,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">"study_id"</span> <span class="ot">=</span> studyId)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">available_profiles</span>(<span class="st">"blca_nmibc_2017"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
  molecularAlterationType datatype name  descr…¹ showP…² patie…³ molec…⁴ studyId
  &lt;chr&gt;                   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   &lt;lgl&gt;   &lt;lgl&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 COPY_NUMBER_ALTERATION  DISCRETE Puta… Copy N… TRUE    FALSE   blca_n… blca_n…
2 MUTATION_EXTENDED       MAF      Muta… Mutati… TRUE    FALSE   blca_n… blca_n…
3 STRUCTURAL_VARIANT      SV       Stru… Struct… TRUE    FALSE   blca_n… blca_n…
# … with abbreviated variable names ¹​description, ²​showProfileInAnalysisTab,
#   ³​patientLevel, ⁴​molecularProfileId</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>all_genomic <span class="ot">&lt;-</span> <span class="fu">get_genetics_by_study</span>(<span class="st">"blca_nmibc_2017"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Returning all data for the "blca_nmibc_2017_mutations" molecular profile in the "blca_nmibc_2017" study</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Returning all data for the "blca_nmibc_2017_cna" molecular profile in the "blca_nmibc_2017" study</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Returning all data for the "blca_nmibc_2017_structural_variants" molecular profile in the "blca_nmibc_2017" study</code></pre>
</div>
</div>
</section>
<section id="processing-data" class="level1">
<h1>Processing Data</h1>
<p>Some research samples included in this study</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>s1_all <span class="ot">&lt;-</span> <span class="fu">available_samples</span>(<span class="st">"blca_nmibc_2017"</span>) </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>s1_all <span class="ot">&lt;-</span> s1_all<span class="sc">$</span>sampleId</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>s1_all[<span class="dv">90</span><span class="sc">:</span><span class="dv">105</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "P-0008234-T01-IM5" "P-0008240-T01-IM5" "P-0008734-T01-IM5"
 [4] "P-0008834-T01-IM5" "P-0008867-T01-IM5" "P-0008880-T01-IM5"
 [7] "P-0009371-T01-IM5" "P-0010271-T01-IM5" "P-0010316-T01-IM5"
[10] "P-0010531-T01-IM5" "s_DS_nmibc_007_P"  "s_DS_nmibc_008_P" 
[13] "s_DS_nmibc_010_P"  "s_DS_nmibc_011_P"  "s_DS_nmibc_014_P" 
[16] "s_DS_nmibc_019_P" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mutations <span class="ot">&lt;-</span> all_genomic<span class="sc">$</span>mutation</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>cna <span class="ot">&lt;-</span> all_genomic<span class="sc">$</span>cna</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fusions <span class="ot">&lt;-</span> all_genomic<span class="sc">$</span>structural_variant</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="check-mutation-status" class="level2">
<h2 class="anchored" data-anchor-id="check-mutation-status">Check Mutation Status</h2>
<p>Sometimes you may want to code ‘Unknown’ as ‘Somatic’.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mutations<span class="sc">$</span>mutationStatus, <span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        SOMATIC SOMATIC_VS_POOL         UNKNOWN            &lt;NA&gt; 
           1557              28              10               0 </code></pre>
</div>
</div>
</section>
<section id="zero-alteration-patients" class="level2">
<h2 class="anchored" data-anchor-id="zero-alteration-patients">Zero Alteration Patients</h2>
<p>These patients have zero mutations. Be careful to include in your analysis data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(s1_all, mutations<span class="sc">$</span>sampleId)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P-0003677-T01-IM5" "P-0005590-T01-IM5"</code></pre>
</div>
</div>
</section>
<section id="create-gene-binary-matrix" class="level2">
<h2 class="anchored" data-anchor-id="create-gene-binary-matrix">Create Gene Binary Matrix</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_gene_binary</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples =</span> s1_all, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mutation =</span> mutations, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cna =</span> cna, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fusion =</span> fusions</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above will give you an error! you need to do some data manipulation first:</p>
<p>!! NOTE: This may change in the upcoming months to be more user friendly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mutations_clean <span class="ot">&lt;-</span> <span class="fu">rename_columns</span>(mutations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `x` must be a one- or two-column data frame in `deframe()`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! hugoGeneSymbol renamed Hugo_Symbol
! entrezGeneId renamed Entrez_Gene_Id
! center renamed Center
! ncbiBuild renamed NCBI_Build
! chr renamed Chromosome
! startPosition renamed Start_Position
! endPosition renamed End_Position
! mutationType renamed Variant_Classification
! variantType renamed Variant_Type
! referenceAllele renamed Reference_Allele
! sampleId renamed Tumor_Sample_Barcode
! validationStatus renamed Validation_Status
! mutationStatus renamed Mutation_Status
! proteinChange renamed HGVSp_Short
! variantAllele renamed Allele</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cna_clean <span class="ot">&lt;-</span>cna <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"hugo_symbol"</span> <span class="ot">=</span> hugoGeneSymbol)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>cna_clean <span class="ot">&lt;-</span> <span class="fu">reformat_cna</span>(cna_clean)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>fusions_clean <span class="ot">&lt;-</span> fusions <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Hugo_Symbol"</span> <span class="ot">=</span> site1HugoSymbol) <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_columns</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `x` must be a one- or two-column data frame in `deframe()`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! ncbiBuild renamed NCBI_Build
! sampleId renamed Tumor_Sample_Barcode</code></pre>
</div>
</div>
</section>
<section id="check-zero-patients" class="level2">
<h2 class="anchored" data-anchor-id="check-zero-patients">Check Zero Patients</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>binmat1 <span class="ot">&lt;-</span> <span class="fu">create_gene_binary</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples =</span> s1_all, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mutation =</span> mutations_clean</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>binmat2 <span class="ot">&lt;-</span> <span class="fu">create_gene_binary</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  samples = s1_all, </span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mutation =</span> mutations_clean</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ `samples` argument is `NULL`. We will infer your cohort inclusion and resulting data frame will include all samples with at least one alteration in mutation, fusion or cna data frames</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(<span class="fu">rownames</span>(binmat1), <span class="fu">rownames</span>(binmat2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P-0003677-T01-IM5" "P-0005590-T01-IM5"</code></pre>
</div>
</div>
<p>If you didn’t specify samples, your denominator may be undercounted!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>binmat <span class="ot">&lt;-</span> <span class="fu">create_gene_binary</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples =</span> s1_all, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mutation =</span> mutations_clean, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cna =</span> cna_clean, </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fusion =</span> fusions_clean</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(binmat[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  ABL1 PARP1 AKT1 ALK APC BIRC3 AR RHOA ZFHX3 ATM
P-0001453-T01-IM3    1     0    0   0   1     0  0    0     0   0
P-0002166-T01-IM3    0     0    0   0   0     0  0    0     0   0
P-0003238-T01-IM5    0     0    0   0   0     0  0    0     0   0
P-0003257-T01-IM5    0     0    0   0   1     0  0    0     0   0
P-0003261-T01-IM5    1     0    0   0   1     0  0    0     0   1
P-0003352-T01-IM5    0     0    0   0   0     0  0    0     0   0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>binmat <span class="ot">&lt;-</span> binmat <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"sample_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(binmat, <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> sample_id       ABL1      PARP1       AKT1        ALK        APC      BIRC3 
         0          0          0          0          0          0          0 
        AR       RHOA      ZFHX3        ATM        ATR       ATRX        AXL 
         0          0          0          0          0          0          0 
     BARD1      CCND1       BCL6      PRDM1        BLM     BMPR1A      FOXL2 
         0          0          0          0          0          0          0 
     BRCA1       BRAF      BRCA2       CALR      CASP8      RUNX1      CCND2 
         0          0          0          0          0          0          0 
     CCND3       CDH1       CDK8     CDKN1A     CDKN1B     CDKN2A      CEBPA 
         0          0          0          0          0          0          0 
     CHEK1     CREBBP       CRKL      CSF3R     CTNNB1       DAXX      DNMT1 
         0          0          0          0          0          0          0 
    DNMT3A     DNMT3B       E2F3       EGFR      EIF4E      EP300      EPHA3 
         0          0          0          0          0          0          0 
     EPHA5      EPHA7      EPHB1      ERBB2      ERBB3      ERBB4      ERCC2 
         0          0          0          0          0          0          0 
     ERCC4      ERCC5        ERG       ESR1       ETV1       ETV6       EZH2 
         0          0          0          0          0          0          0 
     FANCA      FANCC       FAT1       FGF4      FGFR1      FGFR3      FGFR2 
         0          0          0          0          0          0          0 
     FGFR4         FH      FOXO1       FLT1       FLT3       FLT4       MTOR 
         0          0          0          0          0          0          0 
       FYN      GATA2      GATA3       GLI1       GNAQ       GNAS       GPS2 
         0          0          0          0          0          0          0 
    GRIN2A      GSK3B       MSH6       H1-2      H3-3A      H3-3B        HGF 
         0          0          0          0          0          0          0 
     FOXA1       HRAS     DNAJB1       IDH1      IGF1R       IGF2       IL7R 
         0          0          0          0          0          0          0 
      IL10      INHBA     INPP4A       INSR      INSRR       IRF4       IRS1 
         0          0          0          0          0          0          0 
      JAK1       JAK2       JAK3        JUN        KDR        KIT       KRAS 
         0          0          0          0          0          0          0 
      LMO1     SH2D1A      SMAD2      SMAD4        MAX       MCL1       MDM2 
         0          0          0          0          0          0          0 
      MDM4     MAP3K1       MEN1        MET       MITF       MLH1      KMT2A 
         0          0          0          0          0          0          0 
       MPL       MSH2       MST1      MST1R      MUTYH        MYC       MYCL 
         0          0          0          0          0          0          0 
      MYCN      MYD88      MYOD1        NBN        NF1        NF2     NFE2L2 
         0          0          0          0          0          0          0 
    NFKBIA     NOTCH1     NOTCH2     NOTCH3     NOTCH4       NPM1       NRAS 
         0          0          0          0          0          0          0 
     NTRK1      NTRK3       PAK1     PDGFRA     PDGFRB        PGR    PIK3C2G 
         0          0          0          0          0          0          0 
    PIK3C3     PIK3CA     PIK3CB     PIK3CG     PIK3R1     PIK3R2      PLCG2 
         0          0          0          0          0          0          0 
      PMS1       PMS2      POLD1       POLE    PPP2R1A      PPP6C    PRKAR1A 
         0          0          0          0          0          0          0 
     MAPK1      PTCH1       PTEN      PTPRD      PTPRS       RAC1      RAD21 
         0          0          0          0          0          0          0 
     RAD51     RAD51C     RAD51B     RAD51D      RAD52       RAF1       RARA 
         0          0          0          0          0          0          0 
     RASA1        RB1      KDM5A        REL        RET       RHEB       RIT1 
         0          0          0          0          0          0          0 
      ROS1    RPS6KB2       SDHA       SDHD      SRSF2    SMARCA4    SMARCB1 
         0          0          0          0          0          0          0 
   SMARCD1        SMO       SOX2       SOX9        SRC      STAT3     STAT5A 
         0          0          0          0          0          0          0 
     AURKA      STK11        SYK       TBX3     TCF7L2       TERT     TGFBR1 
         0          0          0          0          0          0          0 
    TGFBR2    TMPRSS2       TP53      TRAF2       TSC1       TSC2       TSHR 
         0          0          0          0          0          0          0 
     U2AF1      KDM6A      VEGFA        VHL        WT1       XPO1       YES1 
         0          0          0          0          0          0          0 
     CXCR4      KMT2D      NCOA3      RBM10      KDM5C     ARID1A      AXIN2 
         0          0          0          0          0          0          0 
      BAP1       H3C4       H3C3       H3C8      H3C10       H3C2       SPOP 
         0          0          0          0          0          0          0 
    RAD54L       CUL3       TP63       IRS2        EED     INPP4B      FUBP1 
         0          0          0          0          0          0          0 
     BCL10     PHOX2B       H3C7    RPS6KA4      LATS1    MAP3K13       KLF4 
         0          0          0          0          0          0          0 
    RECQL4      NCOR1      IKBKE       MDC1      NUP93      KEAP1      FGF19 
         0          0          0          0          0          0          0 
     MED12       AKT3    BCL2L11      SH2B3      RAD50      IKZF1       CTCF 
         0          0          0          0          0          0          0 
     STAG2       PLK2      MALT1      PNRC1      PTPRT      CHEK2       DIS3 
         0          0          0          0          0          0          0 
      SPEN        CIC        MGA     ICOSLG     DICER1      SF3B1       BRD4 
         0          0          0          0          0          0          0 
     SUZ12     TIMM8B      LATS2      GREM1      FOXP1       BBC3      SETD2 
         0          0          0          0          0          0          0 
   ANKRD11       SUFU      CDK12     ERRFI1       TET2       BCOR      RNF43 
         0          0          0          0          0          0          0 
      SHQ1      PBRM1      ASXL2      FBXW7       PAK5     ARID1B      RPTOR 
         0          0          0          0          0          0          0 
     KMT2C      CRLF2       NSD1       COP1      PALB2       TET1     FIP1L1 
         0          0          0          0          0          0          0 
     STK40      BRIP1   ABRAXAS1     ARID5B      TRAF7     CARD11      DOT1L 
         0          0          0          0          0          0          0 
     AMER1      ASXL1      ARID2     RICTOR      H3C13      MEF2B  TACC3.fus 
         0          0          0          0          0          0          0 
 EP300.fus     NA.fus  RAB35.fus  RUNX1.fus  FANCA.fus  FGFR3.fus   BRAF.fus 
         0          0          0          0          0          0          0 
MAP2K1.fus CDKN2A.fus   MDM2.Amp    RB1.Del   ATRX.Amp  PTPRD.Del CDKN2A.Del 
         0          0          0          0          0          0          0 
   ATM.Del CDKN2B.Del  FGF19.Amp  CCND1.Amp   FGF4.Amp   FGF3.Amp INPP4A.Amp 
         0          0          0          0          0          0          0 
  DDR2.Amp   SDHC.Amp   COP1.Amp  EPHA3.Del  EP300.Del  ERBB2.Amp  CDK12.Amp 
         0          0          0          0          0          0          0 
 FGFR1.Amp  FGFR1.Del    SRC.Amp  FGFR3.Amp   TBX3.Amp  U2AF1.Del  BARD1.Del 
         0          0          0          0          0          0          0 
 CXCR4.Del  SH2B3.Amp PTPN11.Amp  RAB35.Amp CDKN1B.Del   DIS3.Del  EPHA5.Del 
         0          0          0          0          0          0          0 
  PAK1.Amp  PPM1D.Amp   MCL1.Amp   RAF1.Amp    VHL.Amp   PAX5.Del  PPP6C.Del 
         0          0          0          0          0          0          0 
   EED.Amp    NF2.Amp NOTCH2.Amp   MYCL.Amp  PRDM1.Amp   E2F3.Amp NKX3-1.Del 
         0          0          0          0          0          0          0 
 SOCS1.Amp   CDK4.Amp SH2D1A.Del  STAG2.Del  FOXP1.Del GRIN2A.Amp  H3C13.Amp 
         0          0          0          0          0          0          0 
 H3C14.Amp RICTOR.Amp   SDHA.Amp   IL7R.Amp   TERT.Amp  PTCH1.Del   RIT1.Amp 
         0          0          0          0          0          0          0 
 CEBPA.Amp  CRLF2.Amp  CD274.Del   JAK2.Del  GATA3.Amp   FAT1.Del  RAD21.Del 
         0          0          0          0          0          0          0 
  XPO1.Amp NKX2-1.Del NFKBIA.Del  MAPK3.Amp    PGR.Del  CHEK1.Del  FOXA1.Amp 
         0          0          0          0          0          0          0 
 FOXA1.Del   YAP1.Del  KMT2A.Del   SDHD.Del  MRE11.Del  BIRC3.Del    CBL.Del 
         0          0          0          0          0          0          0 
 CCND3.Amp  CHEK2.Amp   IDH1.Amp 
         0          0          0 </code></pre>
</div>
</div>
</section>
<section id="annotate-impact-panels" class="level2">
<h2 class="anchored" data-anchor-id="annotate-impact-panels">Annotate IMPACT Panels</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>binmat_panel <span class="ot">&lt;-</span> <span class="fu">create_gene_binary</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples =</span> s1_all, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mutation =</span> mutations_clean, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cna =</span> cna_clean, </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fusion =</span> fusions_clean, </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">specify_panel =</span> <span class="st">"impact"</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>→ Couldn't infer IMPACT panel version from these sample_ids, therefore no NA panel annotation will be done for these: s_DS_nmibc_007_P, s_DS_nmibc_008_P, s_DS_nmibc_010_P, s_DS_nmibc_011_P, s_DS_nmibc_014_P, and s_DS_nmibc_019_P</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(binmat_panel, <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x))) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> ABL1 PARP1  AKT1   ALK   APC BIRC3 
    6     6     6     6     6     8 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>sample_panel_pair <span class="ot">&lt;-</span> binmat <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  rownames_to_column("sample_id") %&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_id)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>sample_panel_pair <span class="ot">&lt;-</span> sample_panel_pair <span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">panel_id =</span> <span class="fu">case_when</span>(</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_detect</span>(.data<span class="sc">$</span>sample_id, <span class="st">"-IM3"</span>) <span class="sc">~</span> <span class="st">"IMPACT341"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_detect</span>(.data<span class="sc">$</span>sample_id, <span class="st">"-IM5"</span>) <span class="sc">~</span> <span class="st">"IMPACT410"</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_detect</span>(.data<span class="sc">$</span>sample_id, <span class="st">"-IM6"</span>) <span class="sc">~</span> <span class="st">"IMPACT468"</span>,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_detect</span>(.data<span class="sc">$</span>sample_id, <span class="st">"-IM7"</span>) <span class="sc">~</span> <span class="st">"IMPACT505"</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IMPACT505"</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>binmat_panel <span class="ot">&lt;-</span> <span class="fu">create_gene_binary</span>(</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples =</span> s1_all, </span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">mutation =</span> mutations_clean, </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">cna =</span> cna_clean, </span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">fusion =</span> fusions_clean, </span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">specify_panel =</span> sample_panel_pair</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(binmat_panel, <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x))) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ABL1  PARP1   AKT1    ALK    APC  BIRC3     AR   RHOA  ZFHX3    ATM    ATR 
     0      0      0      0      0      2      0      0      2      0      0 
  ATRX    AXL  BARD1  CCND1   BCL6  PRDM1    BLM BMPR1A  FOXL2  BRCA1   BRAF 
     0      0      0      0      0      0      0      0      0      0      0 
 BRCA2   CALR  CASP8  RUNX1  CCND2  CCND3   CDH1   CDK8 CDKN1A CDKN1B CDKN2A 
     0      2      0      0      0      0      0      0      0      0      0 
 CEBPA  CHEK1 CREBBP   CRKL  CSF3R CTNNB1   DAXX  DNMT1 DNMT3A DNMT3B   E2F3 
     2      0      0      0      2      0      0      0      0      0      0 
  EGFR  EIF4E  EP300  EPHA3  EPHA5  EPHA7 
     0      2      0      0      0      2 </code></pre>
</div>
</div>
<section id="recode-aliases" class="level3">
<h3 class="anchored" data-anchor-id="recode-aliases">Recode Aliases</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>binmat_panel_recode <span class="ot">&lt;-</span> <span class="fu">create_gene_binary</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples =</span> s1_all, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mutation =</span> mutations_clean, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cna =</span> cna_clean, </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fusion =</span> fusions_clean, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">specify_panel =</span> sample_panel_pair, </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">recode_aliases =</span> <span class="cn">TRUE</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>mutations_test <span class="ot">&lt;-</span> mutations_clean <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Hugo_Symbol =</span> </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(Hugo_Symbol <span class="sc">==</span> <span class="st">"ABL1"</span> <span class="sc">~</span> <span class="st">"ABL"</span>, </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">TRUE</span> <span class="sc">~</span> Hugo_Symbol))</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>binmat_panel_recode <span class="ot">&lt;-</span> <span class="fu">create_gene_binary</span>(</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples =</span> s1_all, </span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">mutation =</span> mutations_test, </span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">cna =</span> cna_clean, </span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">fusion =</span> fusions_clean, </span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">recode_aliases =</span> <span class="cn">TRUE</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: To ensure gene with multiple names/aliases are correctly grouped together, the
following genes in your dataframe have been recoded (you can supress this with
`recode_aliases = FALSE`):
! ABL recoded to ABL1</code></pre>
</div>
</div>
</section>
</section>
<section id="oncokb-annotation" class="level2">
<h2 class="anchored" data-anchor-id="oncokb-annotation">OncoKB Annotation</h2>
<div class="cell">

</div>
</section>
</section>
<section id="analyzing-data" class="level1">
<h1>Analyzing Data</h1>
<p>Now that we’ve processed the data we will summarize it. You can use <code>tbl_summary()</code> or the following experimental function which has some benefits:</p>
<ul>
<li>automatically orders genes by frequency</li>
<li>allows you to specify a prevalence threshold cutoff</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_genomic</span>(binmat_panel, <span class="at">freq_cutoff =</span> .<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="jtktkcjijl" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jtktkcjijl .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jtktkcjijl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jtktkcjijl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jtktkcjijl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jtktkcjijl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jtktkcjijl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jtktkcjijl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jtktkcjijl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jtktkcjijl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jtktkcjijl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jtktkcjijl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jtktkcjijl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jtktkcjijl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jtktkcjijl .gt_from_md > :first-child {
  margin-top: 0;
}

#jtktkcjijl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jtktkcjijl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jtktkcjijl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jtktkcjijl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jtktkcjijl .gt_row_group_first td {
  border-top-width: 2px;
}

#jtktkcjijl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jtktkcjijl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jtktkcjijl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jtktkcjijl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jtktkcjijl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jtktkcjijl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jtktkcjijl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jtktkcjijl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jtktkcjijl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jtktkcjijl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jtktkcjijl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jtktkcjijl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jtktkcjijl .gt_left {
  text-align: left;
}

#jtktkcjijl .gt_center {
  text-align: center;
}

#jtktkcjijl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jtktkcjijl .gt_font_normal {
  font-weight: normal;
}

#jtktkcjijl .gt_font_bold {
  font-weight: bold;
}

#jtktkcjijl .gt_font_italic {
  font-style: italic;
}

#jtktkcjijl .gt_super {
  font-size: 65%;
}

#jtktkcjijl .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#jtktkcjijl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jtktkcjijl .gt_indent_1 {
  text-indent: 5px;
}

#jtktkcjijl .gt_indent_2 {
  text-indent: 10px;
}

#jtktkcjijl .gt_indent_3 {
  text-indent: 15px;
}

#jtktkcjijl .gt_indent_4 {
  text-indent: 20px;
}

#jtktkcjijl .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>N = 105</strong><sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left" style="font-weight: bold;">TERT</td>
<td class="gt_row gt_center">77 (73%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">KDM6A</td>
<td class="gt_row gt_center">50 (48%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">FGFR3</td>
<td class="gt_row gt_center">47 (45%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ARID1A</td>
<td class="gt_row gt_center">30 (29%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">PIK3CA</td>
<td class="gt_row gt_center">29 (28%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">KMT2D</td>
<td class="gt_row gt_center">25 (24%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">STAG2</td>
<td class="gt_row gt_center">22 (21%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">CDKN2A</td>
<td class="gt_row gt_center">5 (4.8%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">CREBBP</td>
<td class="gt_row gt_center">22 (21%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">TP53</td>
<td class="gt_row gt_center">22 (21%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ERBB2</td>
<td class="gt_row gt_center">19 (18%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ATM</td>
<td class="gt_row gt_center">16 (15%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ERCC2</td>
<td class="gt_row gt_center">18 (17%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">FAT1</td>
<td class="gt_row gt_center">17 (16%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ARID1B</td>
<td class="gt_row gt_center">17 (16%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">EP300</td>
<td class="gt_row gt_center">15 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">FBXW7</td>
<td class="gt_row gt_center">15 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">PBRM1</td>
<td class="gt_row gt_center">15 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">RBM10</td>
<td class="gt_row gt_center">15 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">MGA</td>
<td class="gt_row gt_center">14 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Unknown</td>
<td class="gt_row gt_center">2</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">BAP1</td>
<td class="gt_row gt_center">13 (12%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">CDKN1A</td>
<td class="gt_row gt_center">12 (11%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ERBB3</td>
<td class="gt_row gt_center">12 (11%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">KMT2C</td>
<td class="gt_row gt_center">12 (11%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">NF1</td>
<td class="gt_row gt_center">12 (11%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">BRCA2</td>
<td class="gt_row gt_center">11 (10%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">SMARCA4</td>
<td class="gt_row gt_center">11 (10%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">SPEN</td>
<td class="gt_row gt_center">11 (10%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">TBX3</td>
<td class="gt_row gt_center">8 (7.6%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">TSC1</td>
<td class="gt_row gt_center">11 (10%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">TERT.Amp</td>
<td class="gt_row gt_center">1 (1.0%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">FGFR3.Amp</td>
<td class="gt_row gt_center">2 (1.9%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ERBB2.Amp</td>
<td class="gt_row gt_center">2 (1.9%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">TBX3.Amp</td>
<td class="gt_row gt_center">3 (2.9%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">STAG2.Del</td>
<td class="gt_row gt_center">2 (1.9%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">CDKN2A.Del</td>
<td class="gt_row gt_center">17 (16%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ATM.Del</td>
<td class="gt_row gt_center">2 (1.9%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">FAT1.Del</td>
<td class="gt_row gt_center">1 (1.0%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">EP300.Del</td>
<td class="gt_row gt_center">1 (1.0%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">CDKN2B.Del</td>
<td class="gt_row gt_center">14 (13%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">FGFR3.fus</td>
<td class="gt_row gt_center">1 (1.0%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">CDKN2A.fus</td>
<td class="gt_row gt_center">1 (1.0%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">EP300.fus</td>
<td class="gt_row gt_center">1 (1.0%)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="2"><sup class="gt_footnote_marks">1</sup> n (%)</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_genomic</span>(binmat_panel,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq_cutoff =</span> .<span class="dv">1</span>, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq_cutoff_by_gene  =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="rzppqcvkve" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rzppqcvkve .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rzppqcvkve .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzppqcvkve .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rzppqcvkve .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rzppqcvkve .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzppqcvkve .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzppqcvkve .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rzppqcvkve .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rzppqcvkve .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rzppqcvkve .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rzppqcvkve .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rzppqcvkve .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rzppqcvkve .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rzppqcvkve .gt_from_md > :first-child {
  margin-top: 0;
}

#rzppqcvkve .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rzppqcvkve .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rzppqcvkve .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rzppqcvkve .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rzppqcvkve .gt_row_group_first td {
  border-top-width: 2px;
}

#rzppqcvkve .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzppqcvkve .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rzppqcvkve .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rzppqcvkve .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzppqcvkve .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzppqcvkve .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rzppqcvkve .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rzppqcvkve .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzppqcvkve .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzppqcvkve .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzppqcvkve .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzppqcvkve .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzppqcvkve .gt_left {
  text-align: left;
}

#rzppqcvkve .gt_center {
  text-align: center;
}

#rzppqcvkve .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rzppqcvkve .gt_font_normal {
  font-weight: normal;
}

#rzppqcvkve .gt_font_bold {
  font-weight: bold;
}

#rzppqcvkve .gt_font_italic {
  font-style: italic;
}

#rzppqcvkve .gt_super {
  font-size: 65%;
}

#rzppqcvkve .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rzppqcvkve .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rzppqcvkve .gt_indent_1 {
  text-indent: 5px;
}

#rzppqcvkve .gt_indent_2 {
  text-indent: 10px;
}

#rzppqcvkve .gt_indent_3 {
  text-indent: 15px;
}

#rzppqcvkve .gt_indent_4 {
  text-indent: 20px;
}

#rzppqcvkve .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>N = 105</strong><sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left" style="font-weight: bold;">TERT</td>
<td class="gt_row gt_center">77 (73%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">KDM6A</td>
<td class="gt_row gt_center">50 (48%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">FGFR3</td>
<td class="gt_row gt_center">47 (45%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ARID1A</td>
<td class="gt_row gt_center">30 (29%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">PIK3CA</td>
<td class="gt_row gt_center">29 (28%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">KMT2D</td>
<td class="gt_row gt_center">25 (24%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">CREBBP</td>
<td class="gt_row gt_center">22 (21%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">STAG2</td>
<td class="gt_row gt_center">22 (21%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">TP53</td>
<td class="gt_row gt_center">22 (21%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ERBB2</td>
<td class="gt_row gt_center">19 (18%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ERCC2</td>
<td class="gt_row gt_center">18 (17%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ARID1B</td>
<td class="gt_row gt_center">17 (16%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">CDKN2A.Del</td>
<td class="gt_row gt_center">17 (16%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">FAT1</td>
<td class="gt_row gt_center">17 (16%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ATM</td>
<td class="gt_row gt_center">16 (15%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">EP300</td>
<td class="gt_row gt_center">15 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">FBXW7</td>
<td class="gt_row gt_center">15 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">PBRM1</td>
<td class="gt_row gt_center">15 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">RBM10</td>
<td class="gt_row gt_center">15 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">MGA</td>
<td class="gt_row gt_center">14 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Unknown</td>
<td class="gt_row gt_center">2</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">CDKN2B.Del</td>
<td class="gt_row gt_center">14 (13%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">BAP1</td>
<td class="gt_row gt_center">13 (12%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">CDKN1A</td>
<td class="gt_row gt_center">12 (11%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">ERBB3</td>
<td class="gt_row gt_center">12 (11%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">KMT2C</td>
<td class="gt_row gt_center">12 (11%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">NF1</td>
<td class="gt_row gt_center">12 (11%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">BRCA2</td>
<td class="gt_row gt_center">11 (10%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">SMARCA4</td>
<td class="gt_row gt_center">11 (10%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">SPEN</td>
<td class="gt_row gt_center">11 (10%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">TSC1</td>
<td class="gt_row gt_center">11 (10%)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="2"><sup class="gt_footnote_marks">1</sup> n (%)</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</section>
<section id="visualizing-data" class="level1">
<h1>Visualizing Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggvarclass</span>(mutations_clean) <span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="impact-example-script_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gggenecor</span>(mutations_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ `samples` argument is `NULL`. We will infer your cohort inclusion and resulting data frame will include all samples with at least one alteration in mutation, fusion or cna data frames</code></pre>
</div>
<div class="cell-output-display">
<p><img src="impact-example-script_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcomut</span>(mutations_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ `samples` argument is `NULL`. We will infer your cohort inclusion and resulting data frame will include all samples with at least one alteration in mutation, fusion or cna data frames</code></pre>
</div>
<div class="cell-output-display">
<p><img src="impact-example-script_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtopgenes</span>(mutations_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="impact-example-script_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Uses <code>ComplexHeatmap::Heatmap()</code> for descriptive heatmap</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggheatmap</span>(binmat_panel_recode[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">150</span><span class="sc">:</span><span class="dv">400</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="impact-example-script_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="get-tmb" class="level2">
<h2 class="anchored" data-anchor-id="get-tmb">Get TMB</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>clin <span class="ot">&lt;-</span> <span class="fu">available_clinical_attributes</span>(<span class="st">"blca_nmibc_2017"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>clin<span class="sc">$</span>clinicalAttributeId <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "AGE"                     "CANCER_TYPE"            
 [3] "CANCER_TYPE_DETAILED"    "CONCOMITANT_CIS"        
 [5] "FRACTION_GENOME_ALTERED" "MUTATION_COUNT"         
 [7] "NUMBER_OF_TUMORS"        "ONCOTREE_CODE"          
 [9] "RECURRENCE"              "SAMPLE_COUNT"           
[11] "SEX"                     "SOMATIC_STATUS"         
[13] "SPECIMEN_TYPE"           "STAGE"                  
[15] "TMB_NONSYNONYMOUS"       "TREATMENT"              
[17] "TUMOR_SIZE"             </code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>